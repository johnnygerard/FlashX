<nav>
  <ul id="nav">
    <li><a href="/">Home</a></li>

    <% if (authenticated) { %>
    <li><a href="/collections">Collections</a></li>
    <li><a href="/training">Training</a></li>
    <li><a href="/account">Account</a></li>
    <% } %>

    <li><a href="/about">About</a></li>

    <% if (authenticated) { %>
    <li id="logout">
      <button type="button">Log out</button>
      <script type="module">
        const button = document.querySelector('#logout>button');

        const addClickListener = handler =>
          button.addEventListener('click', handler, { once: true });

        const handler = async event => {
          try {
            const response = await fetch('/logOut', { method: 'DELETE' });

            if (response.ok) location.pathname = '/';
            else throw new HTTPError;
          } catch (err) {
            console.error(err);
            alert(err instanceof HTTPError ?
              'Operation failed.' : 'Network error');
            addClickListener(handler);
          }
        };
        addClickListener(handler);
      </script>
    </li>
    <% } %>

  </ul>
</nav>
